@using RoboticCoders.Models
@model List<AdminUserViewModel>

@{
    ViewData["Title"] = "Panel de Administraci√≥n";
}

<div class="admin-container">

    <!-- ================= HEADER ================= -->
    <div class="admin-header">
        <div>
            <h2>üìä Panel de Administraci√≥n</h2>
            <p class="admin-subtitle">
                Gesti√≥n de cursos, docentes y estudiantes
            </p>
        </div>

        <div class="admin-actions">
            <a class="btn btn-success" asp-action="Register">‚ûï Usuario</a>
            <a class="btn btn-primary" asp-action="CreateCourse">‚ûï Curso</a>
        </div>
    </div>

    <!-- ================= CURSOS ================= -->
    <div class="admin-card">
        <h3 class="section-title">üì¶ Cursos</h3>

        <div class="table-responsive">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>Curso</th>
                        <th>Docente</th>
                        <th>M√≥dulos</th>
                        <th>Lecciones</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    @{
                        var courses = ViewBag.Courses as List<Course>;
                        if (courses != null && courses.Any())
                        {
                            foreach (var course in courses)
                            {
                                var totalLessons = course.Modules.Sum(m => m.Lessons.Count);
                                <tr>
                                    <td>
                                        <strong>@course.Title</strong>
                                    </td>
                                    <td>
                                        @(string.IsNullOrEmpty(course.TeacherId)
                                            ? "Sin asignar"
                                            : course.TeacherId)
                                    </td>
                                    <td>@course.Modules.Count</td>
                                    <td>@totalLessons</td>
                                    <td class="actions">
                                        <a asp-action="ManageCourse"
                                           asp-route-id="@course.Id"
                                           class="btn-icon settings">
                                            ‚öôÔ∏è
                                        </a>
                                    </td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="5" class="empty">
                                    No hay cursos creados
                                </td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>
    </div>

    <!-- ================= USUARIOS ================= -->
    <div class="admin-card">
        <h3 class="section-title">üë• Usuarios</h3>

        <table class="admin-table">
            <thead>
                <tr>
                    <th>Email</th>
                    <th>Rol</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var user in Model)
                {
                    <tr>
                        <td>@user.Email</td>
                        <td>
                            <span class="role-badge">@user.Role</span>
                        </td>
                        <td class="actions">
                            <a asp-action="EditUser"
                               asp-route-id="@user.Id"
                               class="btn-icon edit">
                                ‚úèÔ∏è
                            </a>
                            <a asp-action="DeleteUser"
                               asp-route-id="@user.Id"
                               class="btn-icon delete">
                                üóëÔ∏è
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

</div>
